{% extends  'main.html' %}
{% load static %}
{% block spider %}

<div class="large-offset-1 large-12 columns">
		<form action="/spider/" method="post" enctype="multipart/form-data">
			{% csrf_token %}
			{{ search_form }}
			<input type='image' src='/media/search.png' width='60' height='60'> 
		</form>
		
		{% if search_form.errors  %}
		{% for error in search_form.errors %}
			{{error}}<br>
		{% endfor %}
		{% endif %}

		<div class="row">
    <div class="large-12 large-offset-2 columns">
   	 <ul class="pagination">

   		 {% for page in pages %}

   			 {% if page == curpage %}
   				 <li class="current">
   					 <a href="/spider/{{ page }}/{{ zap_from_get }}/">{{ page }}</a></li>
   			 {% else %}
   				 <li><a href="/spider/{{ page }}/{{ zap_from_get }}/">{{ page }}</a></li>
   			 {% endif %}

   		 {% endfor %}

   		</ul>
    </div>
</div>
</div>
<script>
var search = document.getElementById("id_search");
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$(search).keyup(function(event){
	if(event.keyCode>=48 && event.keyCode<=90)
	{
		var csrftoken = $.cookie('csrftoken');

		text=$("#id_search").val()
		if(text.length>2)
		{
			$.ajaxSetup
			({
  				beforeSend: function(xhr, settings) {
	        	if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
	            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        		}
    }
			});

			$.ajax
			({
				url: "/spider/",
	            type: 'POST',
	            data: {"search_ajax":text},
	            success: function(){
	                alert();
	            }
			});
		}
	}
});
</script>
{% endblock %}